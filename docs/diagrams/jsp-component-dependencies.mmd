graph LR
    %% JSP Component Dependency Diagram
    
    subgraph "JSP Pages"
        subgraph "Authentication Pages"
            welcome[welcome.jsp]
            register[register.jsp]
        end
        
        subgraph "Trading Pages"
            quote[quote.jsp]
            displayQuote[displayQuote.jsp]
            order[order.jsp]
            portfolio[portfolio.jsp]
        end
        
        subgraph "Account Pages"
            account[account.jsp]
            tradehome[tradehome.jsp]
        end
        
        subgraph "Admin Pages"
            config[config.jsp]
            runStats[runStats.jsp]
            marketSummary[marketSummary.jsp]
            error[error.jsp]
        end
    end
    
    subgraph "Servlet Layer"
        AppServlet["TradeAppServlet<br/>@WebServlet - /app"]
        ConfigServlet["TradeConfigServlet<br/>@WebServlet - /config"]
        TSA[TradeServletAction]
        OrderFilter["OrdersAlertFilter<br/>@WebFilter"]
    end
    
    subgraph "Business Logic"
        TradeAction["TradeAction<br/>Business Facade"]
        TradeServices["TradeServices<br/>Interface"]
        TradeConfig["TradeConfig<br/>Static Config"]
    end
    
    subgraph "EJB Layer"
        SLSB["TradeSLSBBean<br/>@Stateless"]
        DirectSLSB["DirectSLSBBean<br/>@Stateless"]
        TradeDirect["TradeDirect<br/>JDBC Access"]
    end
    
    subgraph "Data Beans"
        AccountDataBean[AccountDataBean]
        AccountProfileDataBean[AccountProfileDataBean]
        OrderDataBean[OrderDataBean]
        QuoteDataBean[QuoteDataBean]
        HoldingDataBean[HoldingDataBean]
        MarketSummaryDataBean[MarketSummaryDataBean]
        RunStatsDataBean[RunStatsDataBean]
    end
    
    subgraph "Utility Classes"
        FinancialUtils[FinancialUtils]
        Log[Log]
        MDBStats[MDBStats]
        KeyBlock[KeyBlock]
    end
    
    subgraph "Collections & Java"
        HashMap[HashMap]
        BigDecimal[BigDecimal]
        Collection[Collection]
        Iterator[Iterator]
    end
    
    %% JSP to Servlet Dependencies
    welcome -.->|form submit| AppServlet
    register -.->|form submit| AppServlet
    quote -.->|navigation| AppServlet
    order -.->|display| AppServlet
    portfolio -.->|actions| AppServlet
    account -.->|update| AppServlet
    tradehome -.->|navigation| AppServlet
    config -.->|form submit| ConfigServlet
    
    %% Servlet Processing
    AppServlet -->|delegates| TSA
    OrderFilter -->|filters| AppServlet
    
    %% JSP Direct Dependencies
    displayQuote ==>|instantiates| TradeAction
    marketSummary ==>|instantiates| TradeAction
    
    %% JSP Include Dependencies
    quote -.->|includes| displayQuote
    tradehome -.->|includes| marketSummary
    
    %% Business Logic Dependencies
    TSA -->|uses| TradeAction
    TradeAction -.->|implements| TradeServices
    TradeAction -->|mode:EJB3| SLSB
    TradeAction -->|mode:Direct| TradeDirect
    
    %% Configuration Dependencies
    config ==>|reads| TradeConfig
    runStats ==>|reads| TradeConfig
    TSA -->|reads| TradeConfig
    
    %% Data Bean Dependencies
    welcome -->|displays| OrderDataBean
    register -->|creates| AccountProfileDataBean
    quote -->|displays| OrderDataBean
    displayQuote -->|uses| QuoteDataBean
    order -->|displays| OrderDataBean
    portfolio -->|uses| AccountDataBean
    portfolio -->|uses| HoldingDataBean
    portfolio -->|uses| QuoteDataBean
    portfolio -->|uses| OrderDataBean
    account -->|uses| AccountDataBean
    account -->|uses| AccountProfileDataBean
    account -->|uses| OrderDataBean
    tradehome -->|uses| AccountDataBean
    tradehome -->|uses| HoldingDataBean
    tradehome -->|uses| OrderDataBean
    marketSummary -->|uses| MarketSummaryDataBean
    marketSummary -->|uses| QuoteDataBean
    runStats -->|uses| RunStatsDataBean
    
    %% Utility Dependencies
    quote ==>|calls| FinancialUtils
    displayQuote ==>|calls| FinancialUtils
    displayQuote ==>|calls| Log
    portfolio ==>|calls| FinancialUtils
    portfolio ==>|calls| Log
    account ==>|calls| FinancialUtils
    tradehome ==>|calls| FinancialUtils
    marketSummary ==>|calls| FinancialUtils
    
    %% Collection Dependencies
    portfolio ==>|uses| HashMap
    portfolio ==>|uses| BigDecimal
    portfolio ==>|uses| Collection
    portfolio ==>|uses| Iterator
    account ==>|uses| Collection
    account ==>|uses| Iterator
    tradehome ==>|uses| Collection
    tradehome ==>|uses| BigDecimal
    marketSummary ==>|uses| Collection
    marketSummary ==>|uses| Iterator
    
    %% EJB to Data Bean
    SLSB -->|returns| AccountDataBean
    SLSB -->|returns| OrderDataBean
    SLSB -->|returns| QuoteDataBean
    SLSB -->|returns| HoldingDataBean
    SLSB -->|returns| MarketSummaryDataBean
    
    %% Styling
    classDef jsp fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    classDef servlet fill:#e8f5e9,stroke:#388e3c,stroke-width:2px
    classDef business fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef ejb fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef data fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef util fill:#f5f5f5,stroke:#616161,stroke-width:2px
    classDef java fill:#eceff1,stroke:#455a64,stroke-width:2px
    
    class welcome,register,quote,displayQuote,order,portfolio,account,tradehome,config,runStats,marketSummary,error jsp
    class AppServlet,ConfigServlet,TSA,OrderFilter servlet
    class TradeAction,TradeServices,TradeConfig business
    class SLSB,DirectSLSB,TradeDirect ejb
    class AccountDataBean,AccountProfileDataBean,OrderDataBean,QuoteDataBean,HoldingDataBean,MarketSummaryDataBean,RunStatsDataBean data
    class FinancialUtils,Log,MDBStats,KeyBlock util
    class HashMap,BigDecimal,Collection,Iterator java
    
    %% Legend for line types
    subgraph "Legend"
        A[JSP Page] -.->|HTTP Request| B[Servlet]
        C[Component] -->|Method Call| D[Component]
        E[JSP] ==>|Direct Access| F[Java Class]
    end