graph TB
    subgraph "DayTrader3 Layered Architecture"
        subgraph "Presentation Layer"
            PRES[Web Tier - daytrader3-ee6-web<br/>- Servlets, JSPs, JSF<br/>- REST endpoints<br/>- User interface logic<br/>- Request/response handling]
        end

        subgraph "Business Logic Layer"
            BIZ[Business Tier - daytrader3-ee6-ejb<br/>- Session beans - EJB3<br/>- Message-driven beans<br/>- Business rules<br/>- Transaction management]
        end

        subgraph "Integration Layer"
            INT[Service Layer<br/>- TradeServices interface<br/>- Service locator pattern<br/>- Dependency injection<br/>- Cross-cutting concerns]
        end

        subgraph "Data Access Layer"
            DATA[Persistence Layer<br/>- JPA entities<br/>- EntityManager<br/>- Named queries<br/>- Transaction coordination]
        end

        subgraph "Data Storage Layer"
            STORE[Database Layer<br/>- Apache Derby<br/>- JDBC data sources<br/>- JTA transactions<br/>- Connection pooling]
        end

        subgraph "Infrastructure Services"
            INFRA[Cross-Cutting Services<br/>- JMS messaging<br/>- Security context<br/>- Logging framework<br/>- Configuration management]
        end
    end

    %% Layer relationships
    PRES -->|HTTP requests<br/>Business delegation| BIZ
    BIZ -->|Service invocation<br/>Transaction boundary| INT
    INT -->|Data operations<br/>Query execution| DATA
    DATA -->|SQL queries<br/>Connection management| STORE
    
    %% Cross-cutting relationships
    INFRA -.->|Logging| PRES
    INFRA -.->|Logging| BIZ
    INFRA -.->|Logging| INT
    INFRA -.->|Logging| DATA
    
    INFRA -.->|Security| PRES
    INFRA -.->|Security| BIZ
    
    INFRA -.->|JMS| BIZ
    
    %% Bidirectional data flow
    STORE -.->|Query results| DATA
    DATA -.->|Entity objects| INT
    INT -.->|DTOs| BIZ
    BIZ -.->|View objects| PRES

    %% Styling
    classDef presentation fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef business fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef integration fill:#e8f5e9,stroke:#388e3c,stroke-width:2px
    classDef data fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef storage fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef infra fill:#f5f5f5,stroke:#616161,stroke-width:2px

    class PRES presentation
    class BIZ business
    class INT integration
    class DATA data
    class STORE storage
    class INFRA infra